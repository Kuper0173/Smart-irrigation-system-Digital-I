# Quinta versión del módulo

En la quinta versión del sistema, el ESP32 gestiona simultáneamente la lectura del sensor de conductividad, la comunicación con la FPGA y la transmisión al módulo Bluetooth. El sensor está conectado al pin GPIO36, donde el ADC interno del ESP32 toma la señal analógica, la digitaliza y la escala a un valor máximo de 1000. Este dato, representando la conductividad en partes por millón, se envía cada 20 milisegundos a la FPGA a través de la UART2, acompañado de un retorno de carro. Al mismo tiempo, el ESP32 transmite al módulo Bluetooth —mediante la UART1— un mensaje informativo que incluye el valor enviado, permitiendo su monitoreo en tiempo real desde un dispositivo externo. Si la FPGA responde, el ESP32 retransmite esa respuesta también al Bluetooth, asegurando la trazabilidad completa de la comunicación. En la FPGA, el sistema espera recibir una cadena de cuatro caracteres; una vez completada la recepción, la almacena en un buffer y la reenvía como eco, confirmando la correcta transferencia. Además, en esta quinta versión se corrigen errores lógicos no detectados en implementaciones previas, específicamente aquellos relacionados con la recepción de datos de longitud variable. Se resuelve, por ejemplo, el caso en el que un valor de 4 bits es recibido antes que uno de 2 bits, o viceversa, garantizando así una interpretación coherente y ordenada de la información transmitida. Esta versión integra completamente la adquisición de un dato real desde el entorno físico, su transmisión al sistema digital y su validación tanto por la FPGA como por el usuario final mediante Bluetooth, cerrando el ciclo completo de captura, procesamiento y verificación de la señal.

